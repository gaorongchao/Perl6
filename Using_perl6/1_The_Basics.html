<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>2: The Basics</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<meta name="title" content="2: The Basics"/>
<meta name="generator" content="Org-mode"/>
<meta name="generated" content="2014-03-22T10:40+0800"/>
<meta name="author" content=""/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  html { font-family: Times, serif; font-size: 12pt; }
  .title  { text-align: center; }
  .todo   { color: red; }
  .done   { color: green; }
  .tag    { background-color: #add8e6; font-weight:normal }
  .target { }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  {margin-left:auto; margin-right:0px;  text-align:right;}
  .left   {margin-left:0px;  margin-right:auto; text-align:left;}
  .center {margin-left:auto; margin-right:auto; text-align:center;}
  p.verse { margin-left: 3% }
  pre {
	border: 1pt solid #AEBDCC;
	background-color: #F3F5F7;
	padding: 5pt;
	font-family: courier, monospace;
        font-size: 90%;
        overflow:auto;
  }
  table { border-collapse: collapse; }
  td, th { vertical-align: top;  }
  th.right  { text-align:center;  }
  th.left   { text-align:center;   }
  th.center { text-align:center; }
  td.right  { text-align:right;  }
  td.left   { text-align:left;   }
  td.center { text-align:center; }
  dt { font-weight: bold; }
  div.figure { padding: 0.5em; }
  div.figure p { text-align: center; }
  div.inlinetask {
    padding:10px;
    border:2px solid gray;
    margin:10px;
    background: #ffffcc;
  }
  textarea { overflow-x: auto; }
  .linenr { font-size:smaller }
  .code-highlighted {background-color:#ffff00;}
  .org-info-js_info-navigation { border-style:none; }
  #org-info-js_console-label { font-size:10px; font-weight:bold;
                               white-space:nowrap; }
  .org-info-js_search-highlight {background-color:#ffff00; color:#000000;
                                 font-weight:bold; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>

</head>
<body>

<div id="preamble">

</div>

<div id="content">
<h1 class="title">2: The Basics</h1>


<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1 第二章：基础</a></li>
</ul>
</div>
</div>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> 第二章：基础</h2>
<div class="outline-text-2" id="text-1">

<p>Perl起源于一个致力于从文本文件中收集整理信息的编程语言。
现在Perl在文本处理方面仍然强大，Perl 5 是一个一般意义上的强力编程语言。
但是Perl 6更为杰出。
</p>
<p>
假设你举办了一个乒乓球联赛。
裁判告诉你比赛结果的格式：选手1 选手2 | 3:2,这意味着，选手1赢了3局，选手2赢了2局。
你需要一个脚本来，来统计选手赢了几场比赛，赢了多少局，并以此决定最终冠军的归属。
</p>
<p>
输入文件格式如下(储存在一个名为"scores"的文件中)：<br/>
</p>


<pre class="example">Beth Ana Charlie Dave 
Ana Dave            |  3:0
Charlie Beth        |  3:1
Ana Beth            |  2:3
Dave Charlie        |  3:0
Ana Charlie         |  3:1
Beth Dave           |  0:3
</pre>


<p>
第一行是所有选手的名字，后面跟着的是每场比赛的结果。
这里有一个解决此问题的Perl 6 脚本:perl-1-1：
</p>


<pre class="example">1 use v6;
2
3 my $file = open 'scores';
4 my @names = $file.get.words;
5
6 my %matches;
7 my %sets;
8
9 for $file.lines -&gt; $line {
10 my ($pairing, $result) = $line.split(' | ');
11 my ($p1, $p2) = $pairing.words;
12 my ($r1, $r2) = $result.split(':');
13
14 %sets{$p1} += $r1;
15 %sets{$p2} += $r2;
16
17 if $r1 &gt; $r2 {
18 %matches{$p1}++;
19 } else {
20 %matches{$p2}++;
21 }
22 }
23
24 my @sorted = @names.sort({ %sets{$_} }).sort({ %matches{$_} }).reverse;
25
26 for @sorted -&gt; $n {
27 say "$n has won %matches{$n} matches and %sets{$n} sets";
28 }
</pre>

<p>
输出文件：
</p>


<pre class="example">Ana has won 2 matches and 8 sets
Dave has won 2 matches and 6 sets
Charlie has won 1 matches and 4 sets
Beth has won 1 matches and 4 sets
</pre>

<p>
没一个Perl6程序都需要以 use v6;。这一行告诉编译器Perl代码的版本。
如果，你不小心用Perl5来运行这个程序，你讲得到错误信息。
</p>
<p>
一个Perl6程序包含0行或者更多的语句。每一个语句以分号结尾，或者以大括号结尾：
</p>


<pre class="example">my $file = open 'scores';
</pre>

<p>
"my"声明一个词法变量。词法变量只有在当前代码块可用，从声明开始到代码块的结束。
如果一个代码块始终没有闭合，那么在文件剩下的所有地方都可以使用。代码块的定义是：
一段在花括号{}之间的代码。
</p>
<p>
一个变量名称以"魔符"开始，魔符是指那些非字母，非数字的符号，比如：$,@,% 或者&amp;-
或者有时出现的双冒号“::”也是。
魔符指明了变量的结构类型，比如：它应该被当作一个值，还是多个值，还是一个子程序，等等。
跟在“魔符”后面的是“标识符“，标识符可以是包含字母，数字和下划线。在字母与字母之间，
你可以用短横线"-"或者撇号"''"。所以"isn't"和double-click 都是合法的变量标识符。
</p>
<p>
魔符 "$" 表明是一个数值变量，指明这个变量只存储了一个值。
</p>
<p>
内建函数"open"打开了一个名为"scores"的文件，然后返回一个文件句柄，
文件句柄是一个代表该文件的对象。
赋值符号"=",把文件句柄赋值给左边的变量，这也就是意味着变量$file现在存储着文件句柄。
</p>
<p>
'scores'是字符串文本（string literal）。字符串（string）是一段纯文本。
字符串文本（string literal)是直接出现在程序中的字符串。
在这一行中，它是提供给open函数的参数。
</p>



<pre class="example">my @names = $file.get.words;
</pre>

<p>
上面语句的左侧调用了一种”方法“&ndash;一个命名的一系列行为的集合体&ndash;获取存储在$file变量中的句柄。
被命名为get的这一方法从文件中读取并返回一行，去掉末尾的换行符。word同样是一个方法，调用从
get中返回的一行文本。word这一方法，分解它的invocant（它要操作的字符串）成一些列的单词。
这里单词的意思是不包含空格的字符串。它把字符串'Beth Ana Charlie Dave'分解成多个字符串
'Beth','Ana','Charlie','Dave'。
</p>
<p>
最后，这一字符串列表存储到数组@names中。魔符@表明所声明的变量是一个数组。数组存储的是有序列表。
</p>



<pre class="example">my %matches;
my %sets;
</pre>


</div>
</div>
</div>

<div id="postamble">
<p class="date">Date: 2014-03-22T10:40+0800</p>
<p class="author">Author: </p>
<p class="creator"><a href="http://orgmode.org">Org</a> version 7.9.3f with <a href="http://www.gnu.org/software/emacs/">Emacs</a> version 24</p>
<a href="http://validator.w3.org/check?uri=referer">Validate XHTML 1.0</a>

</div>
</body>
</html>
